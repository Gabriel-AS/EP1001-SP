<!DOCTYPE html>
<html>
    
    <head>
        <title>Final Project</title>
        <style>
            body {background-color: #202020}
            h1   {text-align: center; background-color: #9A9A9A; color: #202020}
            h2   {text-align: center; color: #2B8094;}
            h3   {text-align: center; color: whitesmoke;}
            h4   {text-align: center; color: whitesmoke;}
            p    {text-align: center; color: aliceblue;}
            a    {text-align: center; color: aliceblue;}
    </style>
        
    </head>
    <body>
        
        <h1>EP1001</h1>
        <h2>Final Project</h2>
        
        <p><kbd>
             For the final project, I am going to build a better LED Nixie display. This is again, going to be heavily<br>
             influenced by the Cronixie project, and instead of a full clock display, I will just construct<br>
             one display, that can display the digits from 0 to 9, and can be controlled by a scroll wheel.<br>
            </kbd></p>
        
            <p><a href= "/Users/STARGAZER/Desktop/DFAB/photo_2020-04-27_07-54-03.jpg">
            <img alt="box" src= "https://gabriel-as.github.io/EP1000-SP/photo_2020-08-13_13-20-32.jpg" height="400"/>
            </a></p>
        
        <p><kbd>
            <strong>List of Materials needed:</strong><br>
            20 WS2812B LEDs<br>
            1 100nF SMD Capacitor<br>
            1 49.9Ohm SMD Resistor<br>
            1 ISP header<br>
            1 Attiny85 IC<br>
            2 Copper PCB Blanks
            <kbd></p>
        
        <p><kbd>
            The main improvement, will be if I can shrink the entire circuit up there, to a single copper blank,<br>
            which leaves me about 75x50mm of space to lay All that. The way I hope to do this, is by fitting the<br>
            Attiny85 onto the same board as the LEDS. On top of that, that one board will also have the ISP header<br>
            and two seperate power supplies, one for the LEDS and another for the Attiny85. Not to mention the 20<br>
            LEDs. I throught of doing a 7 Segment variant, which will be alot simpler, but I am not sure if the Parallax<br>
            offset from one plate to the next would make it look weird.</kbd></p>
        <p>
            <img alt="-Insert google-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-10_14-19-53.jpg" height="500"/>
            </p>
        <p><kbd>
            The circut should not be too difficult, Like last time it only needs 2 I/O pins, one for the LED data line,<br>
            and the other running an analogread for the scroll wheel. I'll also be using the WS2812 Neopixel LED, if I<br>
            cannot get it in a raw package, I might just get a bunch of them premade on a 3x3 matrix board, like last time,<br>
            but instead I will just desolder them from the board and solder them onto my circuit board.<br>
            <kbd></p>
        
            <p>
            <img alt="-Insert githubhere-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-10_14-19-50.jpg" height="500"/>
            </p>
      <p><kbd>
            Before that, I designed a circuit schematic on eagle, and uses the footprint of the WS2812 LED, which I got<br>
            from this github page above.<br>
            <kbd></p>
          
          <p>
            <img alt="-Insert split here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-10_14-19-46.jpg" height="500"/>
            </p>
          
      <p><kbd>
            I ended up chaining the 20 LEDs together first, Dout into Din, to form this massive 20 LED strip, so in theory,<br>
            LEDs 0 and 19 will control number 0, and LEDs 9 and 10 control number 9.<br>
            And here is the schematic with all the other stuff in it. I plan to run this off 2 power supplies, A barrel jack<br>
            sending a steady 5V to the LEDs, and a Micro USB sending 5V to the Attiny85.<br>
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-10_14-19-17.jpg" height="500"/>
            </p>
          
          <p><kbd>
            On some schematics it shows a capacitor between the Power and Ground pins on each LED, so I added it into the design<br>
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-10_14-19-29.jpg" height="500"/>
            </p>
              
            <p><kbd>
            But I then realised it was gonna be a nightmare to untangle in the Board arrangement, so I decided to add a single large<br>
            capacitor between the 5V and ground pins of the LED chain. Here is the final Ratsnest, which just barely fits on a single<br>
            copper blank. 
                  <kbd></p>
                
             <p><kbd>   
            I have a feeling it will struggle to cut properly around the IC chip, so I might set it to cut on just 1 pass.<br>
            The 6 pin header pads are just there to help with soldering on Non Surface Mount components.<br>
            The pad right at the top and the second one from the bottom, those will be a common ground for both power supplies.<br>
            There will be a floating Barrel jack port which connects to the bottom 2 pads by wire, the lowest pad being the 5V.<br>
            The top 3 pads will be connected to a floating Variable Resistor by wire, which will serve as a scroll wheel for input.<br>
            The middle 2nd pad from the top is connected to the analog input on the Attiny85, while the pad just below it is connected<br>
            to the Barrel Jack power supply. This is only a first draft, this is just to help me get a rough understanding of How the<br>
            LED arrangement should look like, and how much space do I have left to work with.<br>
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-10_14-19-10.jpg" height="500"/>
            </p>
                 
         <p><kbd>
            So, a few days have passed. First change, the PCB schematic failed 3 times, which I can only conclude to be because I mistyped<br>
            the trackwidth on DRC to be 6 instead of 16, that and a fouled out V bit.
            <kbd></p>
             <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_15-51-17.jpg" height="500"/>
            </p>
             
             
         <p><kbd>
            So the ripup; command became very useful. Also, the total size of the board was fine<br>
            but calibrating the Stepcraft to ensure everything fit was a nightmare, so I shrunk the total size of the pattern. This is the DRC<br>
            with a track with set to 14 mil, which might be overkill but I was not about to take my chances.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_18-31-07.jpg" height="500"/>
            </p>
             
             <p><kbd>
            And here is the rearranged pattern.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_18-30-56.jpg" height="500"/>
            </p>
                 
                 <p><kbd>
            This is the what I expect to see on the final copper board.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_18-30-59.jpg" height="500"/>
            </p>
                     
                     <p><kbd>
            You can see the changes I made when Comparing the 2 designs
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_18-30-19.jpg" height="500"/>
            </p>
         <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_18-30-08.jpg" height="500"/>
            </p>
                         
            
        <p><kbd>
            Moment of truth, and it turned out fantastic. Another big change was the Z depth, which I previously set to -0.05,<br>
            but even that was too deep. So I instead decided to recalibrate the Z height by putting a piece of folded receipt paper<br>
            under the calibrator cylinder. And immediately I noticed there was much less dust being kicked up by the bit.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_15-50-50.jpg" height="500"/>
            </p>
            
            <p><kbd>
            On top of that, the traces were so smooth, I could run it up against my finger and barely feel the cut.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_15-51-12.jpg" height="500"/>
            </p>
                
                <p><kbd>
            In total I ran 2 boards on the new pattern, the first had a slight Z inconsistency, causing some of the traces to only barely not cut.<br>
            But nothing a little penknife cannot fix, so this became the backup.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_18-24-32.jpg" height="500"/>
            </p>

                    <p><kbd>
            And here is the second board, which cut perfectly. Turns out it was just a matter of shifting the receipt paper around.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_18-24-25.jpg" height="500"/>
            </p>
                        
                        <p><kbd>
            You can really see the difference when lit from behind, This is the one where it did not cut all the way through,
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-30_11-29-35.jpg" height="500"/>
            </p>
                            <p><kbd>
            And this is the one with the clean cuts
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-30_11-29-24.jpg" height="500"/>
            </p>
                                
                <p><kbd>
            Now it was time to start the code. I had to turn this hello board, into something that could run at least one data pin,<br>
            just so I could run the neopixels before I soldered them onto the final board.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_18-37-57.jpg" height="500"/>
            </p>    
                    <p><kbd>
            So, I chose to cut the line above the resistor leading to VCC, and rip off the bypass I soldered from that pin to the button.<br>
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_18-38-17.jpg" height="500"/>
            </p>  
                 <p><kbd>
            Then I soldered a pin to the pad leading straight to the 2nd pin on the IC, or in arduino, Pin 3.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-01-29_18-38-07.jpg" height="500"/>
            </p>         
                  <p><kbd>
            For the neopixels, the serial header on top would provide my VCC and GND, while the new pin would serve as the Din.<br>
            I first tested the neopixels strip I got on an Arduino Mega, and it worked surprisingly well for something I bought<br>
            from a scrap pile. 
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-02-01_13-03-05.jpg" height="500"/>
            </p>

                <p><kbd>
            After a few days of trying to get the code to work and failing over and over again, I can now conclude that the set up<br>
            and running 20 neopixels off an attiny85 Is possible.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-02-08_12-02-13.jpg" height="500"/>
            </p>
                    
                    <p><kbd>
            The first problem was for some reason windows updating tends to mess with your Avrdude toolchain, so I had to redo that.<br>
            The second problem was that the two pieces of code I was looking at, they seem to have neem written by different people,<br>
            I got very confused when two pieces of almost identical code, used slightly differing Keywords as seen here,            
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-02-08_12-13-38.jpg" height="500"/>
            </p>
                        
           <p><kbd>
            The other issue, One of the codes had an additional condition which made running on the attiny85 slightly different.
            That and because the FastLED library from last semester, takes up a ridiculous amount of space on the attiny85, so<br>
            this project uses the not so different but fairly versatile Neopixel library from Adafruit, which can be downloaded<br>
            directly from the Arduino Library manager.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-02-08_12-13-41.jpg" height="500"/>
            </p> 
               
           <p><kbd>
            Now, there are a few ways to desolder SMD components, the way I did it was by blasting the strip with a hot air gun,<br>
            and then banging the strip on the table to fling the LED off the strip once the solder joints are melted. Do note that<br>
            this also flings small chunks of molten solder everywhere, and onto your hand.<br>
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-02-08_12-02-39.jpg" height="500"/>
            </p>
           <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-02-08_12-02-35.jpg" height="500"/>
            </p>    
           <p><kbd>
            The only issue with the hot air gun is that it tends to damage, fragile SMD components, and out of about 31 I desoldered
            Only about 21 didnt get completely melted through. So perhaps next time, run the hot air gun on a lower heat. The ones on
            top left cluster, most of the wirebonds on the silicon chip looked to be completely destroyed.
            <kbd></p>
          <p>
            <img alt="-Insert whole here-" src= "https://gabriel-as.github.io/EP1001-SP/photo_2021-02-08_12-02-31.jpg" height="500"/>
            </p>    
                    
        <p><a href="https://gabriel-as.github.io/EP1001-SP/Main.html">Homepage</a><br><p>
        <p><a href="https://gabriel-as.github.io/EP1001-SP/Part1.html">Electronics Production</a><br><p>
        <p><a href="https://gabriel-as.github.io/EP1001-SP/Part2.html">Electronics Design</a><br><p>
        <p><a href="https://gabriel-as.github.io/EP1001-SP/Part3.html">Embedded Programming</a><br><p>
        <p><a href="https://gabriel-as.github.io/EP1001-SP/Part4.html">2D CNC Machining</a><br><p>
        <p><a href="https://gabriel-as.github.io/EP1001-SP/Part5.html">3D CNC Machining</a><br><p>
        <p><a href="https://gabriel-as.github.io/EP1001-SP/Part6.html">Moulding and Casting</a><br><p>
        <p><a href="https://gabriel-as.github.io/EP1001-SP/Part7.html">Interfacing & Applications Programming</a><br><p>
        <p><a href="https://gabriel-as.github.io/EP1001-SP/Part9.html">Final Project</a><br><p>
        
           <!--<em>Text in italic</em>
               Text in plain
               <kbd>Text in 80s keyboard font</kbd>
               <strong>Text in Bold</strong> -->
        
    </body>
</html>
